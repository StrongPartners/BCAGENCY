name: ğŸ“ GÃ¼nlÃ¼k Blog YazÄ±sÄ± Ãœret

on:
  # Hafta iÃ§i her gÃ¼n 07:00 UTC = 10:00 KKTC saati
  schedule:
    - cron: '0 7 * * 1-5'

  # GitHub arayÃ¼zÃ¼nden elle tetikleme iÃ§in
  workflow_dispatch:
    inputs:
      post_count:
        description: 'KaÃ§ yazÄ± Ã¼retilsin? (varsayÄ±lan: 2)'
        required: false
        default: '2'

permissions:
  contents: write

jobs:
  generate-blog:
    name: Blog YazÄ±sÄ± Ãœret & Deploy Et
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Repoyu Ã§ek
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: âš™ï¸ Node.js 20 kur
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“¦ Anthropic SDK'yÄ± yÃ¼kle
        run: npm install @anthropic-ai/sdk

      - name: ğŸ¤– Blog yazÄ±larÄ±nÄ± Ã¼ret
        run: node scripts/generate-blog.mjs
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}

      - name: ğŸ’¾ DeÄŸiÅŸiklikleri commit et ve push yap
        run: |
          git config user.email "blogbot@bccreative.agency"
          git config user.name "BC Blog Bot"
          git add src/data/blogPosts.js
          if git diff --staged --quiet; then
            echo "Eklenecek yeni yazÄ± yok."
          else
            git commit -m "chore: gÃ¼nlÃ¼k blog yazÄ±larÄ± $(date +'%Y-%m-%d')"
            git push
            echo "âœ… YazÄ±lar commit edildi, Vercel deploy baÅŸlÄ±yor."
          fi
